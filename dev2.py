import base64
from bs4 import BeautifulSoup
from Crypto.Cipher import AES, ChaCha20_Poly1305, PKCS1_OAEP
from Crypto.PublicKey import RSA
from Crypto.Random import get_random_bytes
import datetime
import errno
import hashlib
import json
import math
import os
import PySimpleGUI
import shutil
import socket
import time
import urllib.request
import zlib

a = {"category":"helper-mods","downloads_count":422845,"name":"AfraidOfTheDark","owner":"binbinhfr","releases":[{"download_url":"/download/AfraidOfTheDark/5a5f1ae6adcc441024d72569","file_name":"AfraidOfTheDark_1.0.7.zip","info_json":{"factorio_version":"0.13"},"released_at":"2016-06-28T15:01:45.741000Z","sha1":"d09eda72e7b6535ae8d2f2a441242a580e1b7328","version":"1.0.7"},{"download_url":"/download/AfraidOfTheDark/5a5f1ae6adcc441024d72555","file_name":"AfraidOfTheDark_1.0.8.zip","info_json":{"factorio_version":"0.13"},"released_at":"2016-07-06T15:35:20.670000Z","sha1":"7ac37e724b9f7efdcc1156df79a16dcc12adc86b","version":"1.0.8"},{"download_url":"/download/AfraidOfTheDark/5a5f1ae6adcc441024d74220","file_name":"AfraidOfTheDark_1.0.11.zip","info_json":{"factorio_version":"0.13"},"released_at":"2016-07-14T08:56:04.072000Z","sha1":"87895732132290043833ee129d24bed30afea3da","version":"1.0.11"},{"download_url":"/download/AfraidOfTheDark/5a5f1ae6adcc441024d7286d","file_name":"AfraidOfTheDark_1.0.13.zip","info_json":{"factorio_version":"0.13"},"released_at":"2016-07-24T06:51:07.131000Z","sha1":"17cdaffce346eb99ced13533706e1a7b598a357d","version":"1.0.13"},{"download_url":"/download/AfraidOfTheDark/5a5f1ae6adcc441024d73217","file_name":"AfraidOfTheDark_1.0.14.zip","info_json":{"factorio_version":"0.13"},"released_at":"2016-08-22T16:48:43.051000Z","sha1":"1ce41baeb7cadcac37acc890f0a8a74f4da08ece","version":"1.0.14"},{"download_url":"/download/AfraidOfTheDark/5a5f1ae6adcc441024d73b7b","file_name":"AfraidOfTheDark_1.0.15.zip","info_json":{"factorio_version":"0.14"},"released_at":"2016-08-26T15:31:48.345000Z","sha1":"43f725c5e799583c759a25f87329a6bb289eac51","version":"1.0.15"},{"download_url":"/download/AfraidOfTheDark/5a5f1ae6adcc441024d73f88","file_name":"AfraidOfTheDark_1.0.16.zip","info_json":{"factorio_version":"0.15"},"released_at":"2017-04-28T09:17:26.668000Z","sha1":"1c1348fda6dbb195b33acb9723667507d22994ba","version":"1.0.16"},{"download_url":"/download/AfraidOfTheDark/5a5f1ae6adcc441024d739a4","file_name":"AfraidOfTheDark_1.0.17.zip","info_json":{"factorio_version":"0.16"},"released_at":"2017-12-15T15:22:43.067000Z","sha1":"8714b49cf3b3325e2867e97ba6af5dae2b8e6a77","version":"1.0.17"},{"download_url":"/download/AfraidOfTheDark/5a832f48be1603000cdb8bf5","file_name":"AfraidOfTheDark_1.0.18.zip","info_json":{"factorio_version":"0.16"},"released_at":"2018-02-13T18:32:40.029000Z","sha1":"9bcc1c2205a3ccf09718cdb8a1312005a24180f6","version":"1.0.18"},{"download_url":"/download/AfraidOfTheDark/5a83e7fb30c08a000d20200e","file_name":"AfraidOfTheDark_1.0.19.zip","info_json":{"factorio_version":"0.16"},"released_at":"2018-02-14T07:40:43.648000Z","sha1":"da030dc813793f1ace079a98a576e7227a06cc6c","version":"1.0.19"},{"download_url":"/download/AfraidOfTheDark/5a84baf6ed1d8b000b3f1549","file_name":"AfraidOfTheDark_1.0.20.zip","info_json":{"factorio_version":"0.16"},"released_at":"2018-02-14T22:40:54.740000Z","sha1":"ce0a254794efd9618f3598bce1b9ca48cad3891d","version":"1.0.20"},{"download_url":"/download/AfraidOfTheDark/5c7bb72dc3dad0000b017f58","file_name":"AfraidOfTheDark_1.0.21.zip","info_json":{"factorio_version":"0.17"},"released_at":"2019-03-03T11:14:53.598000Z","sha1":"3ab59ef474be6a88e0eaef774c8f006a7f3b1df6","version":"1.0.21"},{"download_url":"/download/AfraidOfTheDark/5c95038d43820f000c398db8","file_name":"AfraidOfTheDark_1.0.22.zip","info_json":{"factorio_version":"0.17"},"released_at":"2019-03-22T15:47:25.915000Z","sha1":"adfc59dc70902c8f065b3b1730ca72fec0fbe162","version":"1.0.22"},{"download_url":"/download/AfraidOfTheDark/5ccb2e15c725d1000b9ddaa8","file_name":"AfraidOfTheDark_1.0.23.zip","info_json":{"factorio_version":"0.17"},"released_at":"2019-05-02T17:51:17.203000Z","sha1":"e967a1ac22864f026aebe53199411792c4033051","version":"1.0.23"},{"download_url":"/download/AfraidOfTheDark/5e29cf49a5711b000c7fa38e","file_name":"AfraidOfTheDark_1.0.24.zip","info_json":{"factorio_version":"0.18"},"released_at":"2020-01-23T16:52:25.199000Z","sha1":"c38299ac68fcf311b065c7e09b44e41940134258","version":"1.0.24"},{"download_url":"/download/AfraidOfTheDark/5e2b1584339ff2000dc288f8","file_name":"AfraidOfTheDark_1.0.25.zip","info_json":{"factorio_version":"0.18"},"released_at":"2020-01-24T16:04:20.711000Z","sha1":"dd55226b85d08ef1c6a00ad66ed0f3a094ec6125","version":"1.0.25"},{"download_url":"/download/AfraidOfTheDark/5fc380d8772c4ba6455353cb","file_name":"AfraidOfTheDark_1.1.1.zip","info_json":{"factorio_version":"1.1"},"released_at":"2020-11-29T11:07:04.266000Z","sha1":"35d21a531db181ea0b2e08659f6c6b3838dd39e5","version":"1.1.1"},{"download_url":"/download/AfraidOfTheDark/5fdb8315c83d2cb4deba1a05","file_name":"AfraidOfTheDark_1.0.26.zip","info_json":{"factorio_version":"1.0"},"released_at":"2020-12-17T16:11:01.010000Z","sha1":"95c182bc92e456235cc2358d67ecf5ac14c42077","version":"1.0.26"},{"download_url":"/download/AfraidOfTheDark/5fdbd1c95958e4bbfd96181c","file_name":"AfraidOfTheDark_1.0.27.zip","info_json":{"factorio_version":"1.0"},"released_at":"2020-12-17T21:46:49.918000Z","sha1":"ad4eb66dd77844959929b26f0604d318a3e0197c","version":"1.0.27"}],"score":-160.83333333333337,"summary":"Night is too dark for you ? Enforced flashlight and personal lights, powerful balloon lights or a pair of natural tinted night glasses could be the solution !","thumbnail":"/assets/91fef434495f92f35f593b6a6d7d7102a0c8235b.thumb.png","title":"Afraid Of The Dark (enforced personal lights + more)"}
mod_selection = []

for i in range(len(a['releases'])):
    if a['releases'][i]['info_json']['factorio_version'] == '1.1':
        a['releases'][i]['released_at'] = a['releases'][i]['released_at'].replace('T', ' ').replace('Z', '')
        mod_selection .append(a['releases'][i])

mod_selection = sorted(mod_selection, key=lambda x: (time.mktime(datetime.datetime.strptime(x['released_at'], '%Y-%m-%d %H:%M:%S.%f').timetuple())), reverse=True)[0]
print(mod_selection)
